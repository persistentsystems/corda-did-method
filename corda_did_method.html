<!DOCTYPE html><html lang="en" dir="ltr" class=" idcae idcac"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="generator" content="ReSpec 25.3.1"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><style>/* dfn popup panel that list all local references to a dfn */
dfn {
  cursor: pointer;
}

.dfn-panel {
  position: absolute;
  left: var(--left); /* set via JS */
  top: var(--top); /* set via JS */
  z-index: 35;
  height: auto;
  width: max-content;
  max-width: 300px;
  max-height: 500px;
  overflow: auto;
  padding: 0.5em 0.75em;
  font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
  background: #dddddd;
  color: black;
  border: outset 0.2em;
}

.dfn-panel * {
  margin: 0;
}

.dfn-panel > b {
  display: block;
}

.dfn-panel ul a[href] {
  color: black;
}

.dfn-panel a:not(:hover) {
  text-decoration: none !important;
  border-bottom: none !important;
}

.dfn-panel a[href]:hover {
  border-bottom-width: 1px;
}

.dfn-panel > b + b {
  margin-top: 0.25em;
}

.dfn-panel ul {
  padding: 0;
}

.dfn-panel li {
  list-style: inside;
}

.dfn-panel.docked {
  display: inline-block;
  position: fixed;
  left: 0.5em;
  top: unset;
  bottom: 2em;
  margin: 0 auto;
  /* 0.75em from padding (x2), 0.5em from left position, 0.2em border (x2) */
  max-width: calc(100vw - 0.75em * 2 - 0.5em - 0.2em * 2);
  max-height: 30vh;
}
</style>
    <title>Corda DID Method</title>
    
    
    
    
<style id="respec-mainstyle">/*****************************************************************
 * ReSpec specific CSS
 *****************************************************************/
@keyframes pop {
  0% {
    transform: scale(1, 1);
  }
  25% {
    transform: scale(1.25, 1.25);
    opacity: 0.75;
  }
  100% {
    transform: scale(1, 1);
  }
}

/* Override code highlighter background */
.hljs {
  background: transparent !important;
}

/* --- INLINES --- */
h1 abbr,
h2 abbr,
h3 abbr,
h4 abbr,
h5 abbr,
h6 abbr,
a abbr {
  border: none;
}

dfn {
  font-weight: bold;
}

a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
}

a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
}

a.bibref {
  text-decoration: none;
}

.respec-offending-element:target {
  animation: pop 0.25s ease-in-out 0s 1;
}

.respec-offending-element,
a[href].respec-offending-element {
  text-decoration: red wavy underline;
}
@supports not (text-decoration: red wavy underline) {
  .respec-offending-element:not(pre) {
    display: inline-block;
  }
  .respec-offending-element {
    /* Red squiggly line */
    background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=)
      bottom repeat-x;
  }
}

#references :target {
  background: #eaf3ff;
  animation: pop 0.4s ease-in-out 0s 1;
}

cite .bibref {
  font-style: normal;
}

code {
  color: #c83500;
}

th code {
  color: inherit;
}

a[href].orcid {
    padding-left: 4px;
    padding-right: 4px;
}

a[href].orcid > svg {
    margin-bottom: -2px;
}

/* --- TOC --- */

.toc a,
.tof a {
  text-decoration: none;
}

a .secno,
a .figno {
  color: #000;
}

ul.tof,
ol.tof {
  list-style: none outside none;
}

.caption {
  margin-top: 0.5em;
  font-style: italic;
}

/* --- TABLE --- */

table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
}

.simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
}

.simple th a {
  color: #fff;
  padding: 3px 5px;
  text-align: left;
}

.simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
}

.simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
  background: #f0f6ff;
}

/* --- DL --- */

.section dd > p:first-child {
  margin-top: 0;
}

.section dd > p:last-child {
  margin-bottom: 0;
}

.section dd {
  margin-bottom: 1em;
}

.section dl.attrs dd,
.section dl.eldef dd {
  margin-bottom: 0;
}

#issue-summary > ul,
.respec-dfn-list {
  column-count: 2;
}

#issue-summary li,
.respec-dfn-list li {
  list-style: none;
}

details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
}

details.respec-tests-details > * {
  padding-right: 2em;
}

details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: 0.3em;
  background-color: white;
  padding-bottom: 0.5em;
}

details.respec-tests-details[open] > summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
}

details.respec-tests-details > ul {
  width: 100%;
  margin-top: -0.3em;
}

details.respec-tests-details > li {
  padding-left: 1em;
}

a[href].self-link:hover {
  opacity: 1;
  text-decoration: none;
  background-color: transparent;
}

h2,
h3,
h4,
h5,
h6 {
  position: relative;
}

aside.example .marker > a.self-link {
  color: inherit;
}

h2 > a.self-link,
h3 > a.self-link,
h4 > a.self-link,
h5 > a.self-link,
h6 > a.self-link {
  border: none;
  color: inherit;
  font-size: 83%;
  height: 2em;
  left: -1.6em;
  opacity: 0.5;
  position: absolute;
  text-align: center;
  text-decoration: none;
  top: 0;
  transition: opacity 0.2s;
  width: 2em;
}

h2 > a.self-link::before,
h3 > a.self-link::before,
h4 > a.self-link::before,
h5 > a.self-link::before,
h6 > a.self-link::before {
  content: "§";
  display: block;
}

@media (max-width: 767px) {
  dd {
    margin-left: 0;
  }

  /* Don't position self-link in headings off-screen */
  h2 > a.self-link,
  h3 > a.self-link,
  h4 > a.self-link,
  h5 > a.self-link,
  h6 > a.self-link {
    left: auto;
    top: auto;
  }
}

@media print {
  .removeOnSave {
    display: none;
  }
}
</style><style>/*
Atom One Light by Daniel Gamage
Original One Light Syntax theme from https://github.com/atom/one-light-syntax
base:    #fafafa
mono-1:  #383a42
mono-2:  #686b77
mono-3:  #a0a1a7
hue-1:   #0184bb
hue-2:   #4078f2
hue-3:   #a626a4
hue-4:   #50a14f
hue-5:   #e45649
hue-5-2: #c91243
hue-6:   #986801
hue-6-2: #c18401
*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #383a42;
  background: #fafafa;
}

.hljs-comment,
.hljs-quote {
  color: #717277;
  font-style: italic;
}

.hljs-doctag,
.hljs-keyword,
.hljs-formula {
  color: #a626a4;
}

.hljs-section,
.hljs-name,
.hljs-selector-tag,
.hljs-deletion,
.hljs-subst {
  color: #e45649;
}

.hljs-literal {
  color: #0184bb;
}

.hljs-string,
.hljs-regexp,
.hljs-addition,
.hljs-attribute,
.hljs-meta-string {
  color: #42803C;
}

.hljs-built_in,
.hljs-class .hljs-title {
  color: #c18401;
}

.hljs-attr,
.hljs-variable,
.hljs-template-variable,
.hljs-type,
.hljs-selector-class,
.hljs-selector-attr,
.hljs-selector-pseudo,
.hljs-number {
  color: #986801;
}

.hljs-symbol,
.hljs-bullet,
.hljs-link,
.hljs-meta,
.hljs-selector-id,
.hljs-title {
  color: #4078f2;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

.hljs-link {
  text-decoration: underline;
}
</style><script id="initialUserConfig" type="application/json">{
  "xref": true,
  "specStatus": "unofficial",
  "shortName": "xxx-xxx",
  "copyrightStart": "2019",
  "extraCSS": [
    "http://dev.w3.org/2009/dap/ReSpec.js/css/respec.css"
  ],
  "editors": [
    {
      "name": "Abbas Ali",
      "mailto": "abbas.ali@r3.com",
      "company": "R3",
      "companyURL": "https://www.r3.com/"
    },
    {
      "name": "Pandurang Kamat",
      "company": "Persistent Systems",
      "companyURL": "https://www.persistent.com/"
    },
    {
      "name": "Moritz Platt",
      "mailto": "moritz.platt@r3.com",
      "company": "R3",
      "companyURL": "https://www.r3.com/"
    },
	{
      "name": "Arati Baliga",
      "company": "Persistent Systems",
      "companyURL": "https://www.persistent.com/"
    }
  ],
  "authors": [
    
    {
      "name": "Pranav Kirtani",
      "company": "Persistent Systems",
      "companyURL": "https://www.persistent.com/"
    },
    {
      "name": "Nitesh Solanki",
      "company": "Persistent Systems",
      "companyURL": "https://www.persistent.com/"
    }
  ],
  "wg": "In Charge Of This Document Working Group",
  "wgURI": "http://example.org/really-cool-wg",
  "wgPublicList": "spec-writers-anonymous",
  "localBiblio": {
    "corda-whitepaper": {
      "title": "Corda Technical White Paper",
      "href": "https://www.r3.com/reports/corda-technical-whitepaper/",
      "authors": [
        "Mike Hearn",
        "Richard Gendal Brown"
      ],
      "id": "corda-whitepaper"
    },
    "corda-messaging": {
      "title": "Corda Networking and Messaging",
      "href": "https://docs.corda.net/messaging.html",
      "id": "corda-messaging"
    },
    "corda-network": {
      "title": "Corda Network Foundation",
      "href": "https://corda.network/",
      "id": "corda-network"
    },
    "corda-testnet": {
      "title": "Corda Testnet",
      "href": "https://docs.corda.net/head/corda-testnet-intro.html",
      "id": "corda-testnet"
    },
    "multibase": {
      "title": "The Multibase Data Format",
      "href": "https://tools.ietf.org/id/draft-multiformats-multibase-00.html",
      "authors": [
        "J. Benet",
        "M. Sporny"
      ],
      "id": "multibase"
    }
  },
  "_ijt": "59oq71sb5brqa2js61njrbfdiv",
  "publishISODate": "2020-03-02T00:00:00.000Z",
  "generatedSubtitle": "Unofficial Draft 02 March 2020"
}</script><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-UD"></head>
<body class="h-entry informative"><div class="head">
       <h1 id="title" class="title">Corda DID Method</h1>
      
      <h2>
        Unofficial Draft
        <time class="dt-published" datetime="2020-03-02">02 March 2020</time>
      </h2>
      <dl>
        
        
        
        
        
        
        
        <dt>Editors:</dt>
        <dd class="p-author h-card vcard"><a class="ed_mailto u-email email p-name" href="mailto:abbas.ali@r3.com">Abbas Ali</a>
            (<a class="p-org org h-org h-card" href="https://www.r3.com/">R3</a>)
          </dd><dd class="p-author h-card vcard"><span class="p-name fn">Pandurang Kamat</span>
            (<a class="p-org org h-org h-card" href="https://www.persistent.com/">Persistent Systems</a>)
          </dd><dd class="p-author h-card vcard"><a class="ed_mailto u-email email p-name" href="mailto:moritz.platt@r3.com">Moritz Platt</a>
            (<a class="p-org org h-org h-card" href="https://www.r3.com/">R3</a>)
          </dd>
		  <dd class="p-author h-card vcard"><span class="p-name fn">Arati Baliga</span>(<a class="p-org org h-org h-card" href="https://www.persistent.com/">Persistent Systems</a>)
          </dd>
        
        <dt>
                Authors:
              </dt>
            <dd class="p-author h-card vcard"><span class="p-name fn">Pranav Kirtani</span>
            (<a class="p-org org h-org h-card" href="https://www.persistent.com/">Persistent Systems</a>)
          </dd><dd class="p-author h-card vcard"><span class="p-name fn">Nitesh Solanki</span>
            (<a class="p-org org h-org h-card" href="https://www.persistent.com/">Persistent Systems</a>)
          </dd>
        
      </dl>
      
      
      
      <p class="copyright">
            This document is licensed under a
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/" class="subfoot">Creative Commons Attribution 4.0 License</a>.
          </p>
      <hr title="Separator for header">
    </div>
<section id="abstract" class="introductory"><h2>Abstract</h2>
    The Corda DID method aims to implement the Decentralized Identifiers requirements [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">did-core</a></cite>] on Corda networks.
    The Corda DID method is a hybrid, exposing both Corda specific means of communication (Corda's peer-to-peer
    messaging protocol [<cite><a class="bibref" data-link-type="biblio" href="#bib-corda-messaging" title="Corda Networking and Messaging">corda-messaging</a></cite>]), as well as a more widely recognised protocol for end-users (JSON over
    HTTPS).
</section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#overall-architecture"><bdi class="secno">2. </bdi>Overall Architecture</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#networks"><bdi class="secno">2.1 </bdi>Networks</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#member-node-end-points"><bdi class="secno">2.1.1 </bdi>Member Node End Points</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#testnet"><bdi class="secno">2.1.1.1 </bdi>Testnet</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#http-end-points"><bdi class="secno">2.1.1.1.1 </bdi>HTTP End Points</a></li><li class="tocline"><a class="tocxref" href="#corda-peer-to-peer-end-points"><bdi class="secno">2.1.1.1.2 </bdi>Corda Peer-to-Peer End Points</a></li></ol></li><li class="tocline"><a class="tocxref" href="#corda-network"><bdi class="secno">2.1.1.2 </bdi>Corda Network</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#http-end-points-0"><bdi class="secno">2.1.1.2.1 </bdi>HTTP End Points</a></li><li class="tocline"><a class="tocxref" href="#corda-peer-to-peer-end-points-0"><bdi class="secno">2.1.1.2.2 </bdi>Corda Peer-to-Peer End Points</a></li></ol></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#methods"><bdi class="secno">3. </bdi>Methods</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#corda-did-format"><bdi class="secno">3.1 </bdi>Corda DID Format</a></li><li class="tocline"><a class="tocxref" href="#json-over-https-api"><bdi class="secno">3.2 </bdi>JSON over HTTPS API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#message-format"><bdi class="secno">3.2.1 </bdi>Message Format</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#instruction"><bdi class="secno">3.2.1.1 </bdi>Instruction</a></li><li class="tocline"><a class="tocxref" href="#supported-encodings"><bdi class="secno">3.2.1.2 </bdi>Supported Encodings</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">3.2.1.2.1 </bdi>Examples</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#base58"><bdi class="secno">3.2.1.2.1.1 </bdi>Base58</a></li><li class="tocline"><a class="tocxref" href="#multibase"><bdi class="secno">3.2.1.2.1.2 </bdi>Multibase</a></li><li class="tocline"><a class="tocxref" href="#hex"><bdi class="secno">3.2.1.2.1.3 </bdi>Hex</a></li><li class="tocline"><a class="tocxref" href="#base64"><bdi class="secno">3.2.1.2.1.4 </bdi>Base64</a></li></ol></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#http-communication"><bdi class="secno">3.3 </bdi>HTTP Communication</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-did"><bdi class="secno">3.3.1 </bdi>Create DID</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#request"><bdi class="secno">3.3.1.1 </bdi>Request</a></li><li class="tocline"><a class="tocxref" href="#response"><bdi class="secno">3.3.1.2 </bdi>Response</a></li></ol></li><li class="tocline"><a class="tocxref" href="#read-did"><bdi class="secno">3.3.2 </bdi>Read DID</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#request-0"><bdi class="secno">3.3.2.1 </bdi>Request</a></li><li class="tocline"><a class="tocxref" href="#response-0"><bdi class="secno">3.3.2.2 </bdi>Response</a></li></ol></li><li class="tocline"><a class="tocxref" href="#update-did"><bdi class="secno">3.3.3 </bdi>Update DID</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#request-1"><bdi class="secno">3.3.3.1 </bdi>Request</a></li><li class="tocline"><a class="tocxref" href="#response-1"><bdi class="secno">3.3.3.2 </bdi>Response</a></li></ol></li><li class="tocline"><a class="tocxref" href="#delete-did"><bdi class="secno">3.3.4 </bdi>Delete DID</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#request-2"><bdi class="secno">3.3.4.1 </bdi>Request</a></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#implementation-considerations"><bdi class="secno">4. </bdi>Implementation Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-did-createdidflow"><bdi class="secno">4.1 </bdi>Create DID (<em>CreateDidFlow</em>)</a></li><li class="tocline"><a class="tocxref" href="#read-did-fetchdiddocumentflow"><bdi class="secno">4.2 </bdi>Read DID (<em>FetchDidDocumentFlow</em>)</a></li><li class="tocline"><a class="tocxref" href="#update-did-updatedidflow"><bdi class="secno">4.3 </bdi>Update DID (<em>UpdateDidFlow</em>)</a></li><li class="tocline"><a class="tocxref" href="#delete-did-deletedidflow"><bdi class="secno">4.4 </bdi>Delete DID (<em>DeleteDidFlow</em>)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#tof"><bdi class="secno">A. </bdi>List of Figures</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">B.1 </bdi>Informative references</a></li></ol></li></ol></nav>

<section id="introduction">
    <h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2>
    <p>
        To understand the environment in which the Corda DID method operates, the permissioned nature of a Corda network
        and the point-to-point approach to data replication must be taken into account.
        While parties on permissionless blockchains remain are anonymous, and can join and leave at will, any Corda
        network utilises a standard PKIX infrastructure for linking public keys to identities [<cite><a class="bibref" data-link-type="biblio" href="#bib-corda-whitepaper" title="Corda Technical White Paper">corda-whitepaper</a></cite>].
        As such, individually deployed entities on the network—nodes—have a strong notion of identity. This concept
        is instrumental to network communication.
        Similarly, the data replication model implemented in Corda is different from that of a conventional public
        blockchain that makes all on-ledger data visible to all network participants.
        In Corda, data is distributed to a configurable subset of network members only.
    </p>
</section>
<section id="overall-architecture">
    <h2 id="x2-overall-architecture"><bdi class="secno">2. </bdi>Overall Architecture</h2>
    <p>
        The Corda DID method operates in an environment in which multiple nodes form a consortium to replicate
        decentralised identity data (cf. <a href="#high-level-architecture">figure 1</a>).
        These consortium nodes replicate decentralised identifier documents to form a network-wide eventually consistent
        view of the unity of decentralised identifiers using the Corda DID method.
    </p>
    <figure id="high-level-architecture">
        <img src="high_level_architecture.svg" height="339" width="1050">
        <figcaption>Figure <bdi class="figno">1</bdi> <span class="fig-title">The high level network architecture of a Corda network with three consortium nodes.</span></figcaption>
    </figure>
    <p>
        Replication is implemented via the Corda peer-to-peer protocol and invoked via the Corda Flow Framework.
        Since replication between consortium members is not a public aspect of the DID method, it will not be discussed
        in detail in this specification.
    </p>

    <p>
        External parties, i.e. those not part of the consortium, can utilise the Corda DID method to create, read,
        update and delete DID documents via two API:
    </p>
    <ol>
        <li>The JSON over HTTPS protocol</li>
        <li>The Corda peer-to-peer protocol</li>
    </ol>
    <p id="expert-users">
        Only the former (JSON over HTTPS) is a documented aspect of the DID method at the time of writing.
        The latter is intended for expert users who wish to make use of DID within the context of Corda's flow
        framework.
        A formal specification of this API is the subject of future work.
    </p>

    <section id="networks">
        <h3 id="x2-1-networks"><bdi class="secno">2.1 </bdi>Networks</h3>

        <p>
            DID are to be replicated between nodes on the same Corda network.
            Ultimately, the target network for the method is the Corda Network [<cite><a class="bibref" data-link-type="biblio" href="#bib-corda-network" title="Corda Network Foundation">corda-network</a></cite>].
            While the method specification is evolving, an ephemeral environment for experimentation with the concept
            will be provided.
        </p>

        <table>
            <tbody><tr>
                <th>Network</th>
                <th>Stage</th>
                <th>Purpose</th>
                <th>Consortium Members</th>
            </tr>
            <tr>
                <td>Testnet [<cite><a class="bibref" data-link-type="biblio" href="#bib-corda-testnet" title="Corda Testnet">corda-testnet</a></cite>]</td>
                <td>Test</td>
                <td>Enabling experimentation with the method in an ephemeral environment.<br>
                    DID are not expected to be persisted permanently.
                </td>
                <td>to be defined</td>
            </tr>
            <tr>
                <td>Corda Network [<cite><a class="bibref" data-link-type="biblio" href="#bib-corda-network" title="Corda Network Foundation">corda-network</a></cite>]</td>
                <td>Live</td>
                <td>Production ready environment replicating DID on a permanent basis.</td>
                <td>to be defined</td>
            </tr>
        </tbody></table>

        <section id="member-node-end-points">
            <h4 id="x2-1-1-member-node-end-points"><bdi class="secno">2.1.1 </bdi>Member Node End Points</h4>

            <p>
                Consortium member nodes have to maintain a permanent host name or IP address for both Corda peer-to-peer
                communication and to expose the HTTP server that operates the API.
                These host names/IP addresses can be different.
            </p>

            <section id="testnet">
                <h5 id="x2-1-1-1-testnet"><bdi class="secno">2.1.1.1 </bdi>Testnet</h5>

                <section id="http-end-points">
                    <h6 id="x2-1-1-1-1-http-end-points"><bdi class="secno">2.1.1.1.1 </bdi>HTTP End Points</h6>
                    <table>
                        <tbody><tr>
                            <th>Consortium Member</th>
                            <th>Host Name</th>
                            <th>Port</th>
                        </tr>
                        <tr>
                            <td colspan="3">to be defined</td>
                        </tr>
                    </tbody></table>
                </section>

                <section id="corda-peer-to-peer-end-points">
                    <h6 id="x2-1-1-1-2-corda-peer-to-peer-end-points"><bdi class="secno">2.1.1.1.2 </bdi>Corda Peer-to-Peer End Points</h6>
                    <table>
                        <tbody><tr>
                            <th>Consortium Member</th>
                            <th>Host Name</th>
                            <th>Port</th>
                        </tr>
                        <tr>
                            <td colspan="3">to be defined</td>
                        </tr>
                    </tbody></table>
                </section>
            </section>
            <section id="corda-network">
                <h5 id="x2-1-1-2-corda-network"><bdi class="secno">2.1.1.2 </bdi>Corda Network</h5>

                <section id="http-end-points-0">
                    <h6 id="x2-1-1-2-1-http-end-points"><bdi class="secno">2.1.1.2.1 </bdi>HTTP End Points</h6>
                    <table>
                        <tbody><tr>
                            <th>Consortium Member</th>
                            <th>Host Name</th>
                            <th>Port</th>
                        </tr>
                        <tr>
                            <td colspan="3">to be defined</td>
                        </tr>
                    </tbody></table>
                </section>

                <section id="corda-peer-to-peer-end-points-0">
                    <h6 id="x2-1-1-2-2-corda-peer-to-peer-end-points"><bdi class="secno">2.1.1.2.2 </bdi>Corda Peer-to-Peer End Points</h6>
                    <table>
                        <tbody><tr>
                            <th>Consortium Member</th>
                            <th>Host Name</th>
                            <th>Port</th>
                        </tr>
                        <tr>
                            <td colspan="3">to be defined</td>
                        </tr>
                    </tbody></table>
                </section>
            </section>
        </section>
    </section>
</section>


<section id="methods">
    <h2 id="x3-methods"><bdi class="secno">3. </bdi>Methods</h2>
    <p>End users that aim to <em>create</em>, <em>read</em>, <em>update</em> or <em>delete</em> DID documents can do so
        by interacting with a trusted node of their choosing.
        The API provided for interaction is exposing REST endpoints over HTTP, using a JSON based envelope format
        closely aligned with the JSON-LD examples found in the DID draft community report [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">did-core</a></cite>].
    </p>
    <p>When users interact with consortium member nodes, their requests will be handled by a <em>web server</em> that
        transforms the requests into a <a href="https://docs.corda.net/clientrpc.html">format suitable for Corda</a>.
        The web server component is running in a process independent of Corda.
        User calls ‘proxied’ through this way will invoke a <a href="https://docs.corda.net/key-concepts-flows.html">Flow</a>
        on one of the consortium nodes.
        As part of this flow, consortium nodes will validate that the id provided by the user is valid and that the
        message has cryptographic integrity (i.e. that the DID document is signed properly).
        Once this validation was successful, DID documents will be replicated from the <em>trusted node</em> (i.e. the
        node the user chose to interact with via REST) to all <em>witness nodes</em> (i.e. all other nodes in the
        consortium).
        Witness nodes will perform a cryptographic integrity check as part of the <a href="https://docs.corda.net/key-concepts-contracts.html">contract</a> underpinning this
        transaction.</p>

    <section id="corda-did-format">
        <h3 id="x3-1-corda-did-format"><bdi class="secno">3.1 </bdi>Corda DID Format</h3>

        <p>
            A Corda DID specifies the <code>corda</code> method, a target network (e.g. <code>testnet</code>,
            <code>tcn</code>) and a UUID formatted in the canonical string representation [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4122" title="A Universally Unique IDentifier (UUID) URN Namespace">rfc4122</a></cite>]:
        </p>

        <code>
            did:corda:(testnet|tcn|private-[a-z]+):([0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12})
        </code>

        <p>
        </p><table>
            <tbody><tr>
                <th>Target Network</th>
                <th>Network Tag</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td>Testnet [<cite><a class="bibref" data-link-type="biblio" href="#bib-corda-testnet" title="Corda Testnet">corda-testnet</a></cite>]</td>
                <td><code>testnet</code></td>
                <td>Signifies that the document can be resolved via Testnet.</td>
            </tr>
            <tr>
                <td>Corda Network [<cite><a class="bibref" data-link-type="biblio" href="#bib-corda-network" title="Corda Network Foundation">corda-network</a></cite>]</td>
                <td><code>tcn</code></td>
                <td>Signifies that the document can be resolved via the Corda Network.</td>
            </tr>
            <tr>
                <td>Private</td>
                <td><code>private-*</code></td>
                <td>Signifies that the document cannot be resolved via a standard mechanism. This tag is intended for
                    use in private networks and in testing.
                </td>
            </tr>
        </tbody></table>

        I.e.

        <ul>
            <li><code>did:corda:testnet:559d1c8f-75dd-477f-b28a-ef9d96c4e802</code></li>
            <li><code>did:corda:tcn:ffe0f4ff-8740-470d-bb4c-0b642f58e0f5</code></li>
            <li><code>did:corda:private-persistent:d3b91530-67f5-48b8-bf1c-e883b1fea766</code></li>
        </ul>
        <p></p>
    </section>

    <section id="json-over-https-api">
        <h3 id="x3-2-json-over-https-api"><bdi class="secno">3.2 </bdi>JSON over HTTPS API</h3>

        <p>The DID API is the server component to be deployed by consortium member nodes in conjunction with the
            CorDapp.
            It provides Method specific APIs to <em>create</em>, <em>read</em>, <em>update</em> or <em>delete</em> DID
            documents.
            The Corda DID method achieves proof-of-ownership of a <em>document</em> by requiring proof-of-ownership of
            the <em>keys</em> contained in the document.
            To implement that, any DID document must be wrapped in an envelope.
            This envelope must contain signatures by all private keys associated with the public keys contained in the
            documents (cf. <a href="#did-envelope">figure 2</a>).
        </p>
        <figure id="did-envelope">
            <img src="did_envelope.svg" height="352" width="518">
            <figcaption>Figure <bdi class="figno">2</bdi> <span class="fig-title">A DID envelope holds the document payload and signatures over the payload by relevant keys.
            </span></figcaption>
        </figure>
        <p>
            Envelopes that do not contain signatures for all public keys will be rejected.
            Envelopes using unsupported cryptographic suites or unsupported serialization mechanisms will be rejected.
            There are restrictions on which suites and serialisation mechanisms can be used (see <em>Caveats</em>
            below).
        </p>
        <section id="message-format">
            <h4 id="x3-2-1-message-format"><bdi class="secno">3.2.1 </bdi>Message Format</h4>

            <section id="instruction">
                <h5 id="x3-2-1-1-instruction"><bdi class="secno">3.2.1.1 </bdi>Instruction</h5>

                <p>
                    Instruction data tells the API what to do with the document received. It also contains proof of
                    ownership of keys. The instruction data is to be formatted according to the following schema:
                </p>

                <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"definitions"</span>: {},
  <span class="hljs-attr">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">"required"</span>: [
    <span class="hljs-string">"action"</span>,
    <span class="hljs-string">"signatures"</span>
  ],
  <span class="hljs-attr">"properties"</span>: {
    <span class="hljs-attr">"action"</span>: {
      <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"#/properties/action"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-attr">"enum"</span>: [
        <span class="hljs-string">"create"</span>,
        <span class="hljs-string">"read"</span>,
        <span class="hljs-string">"update"</span>,
        <span class="hljs-string">"delete"</span>
      ]
    },
    <span class="hljs-attr">"signatures"</span>: {
      <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"#/properties/signatures"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"array"</span>,
      <span class="hljs-attr">"items"</span>: {
        <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"#/properties/signatures/items"</span>,
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">"required"</span>: [
          <span class="hljs-string">"id"</span>,
          <span class="hljs-string">"type"</span>,
          <span class="hljs-string">"signatureBase58"</span>
        ],
        <span class="hljs-attr">"properties"</span>: {
          <span class="hljs-attr">"id"</span>: {
            <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"#/properties/signatures/items/properties/id"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The ID of the public key that is part of the key pair signing the document."</span>,
            <span class="hljs-attr">"examples"</span>: [
              <span class="hljs-string">"did:corda:testnet:3df6b0a1-6b02-4053-8900-8c36b6d35fa1#keys-1"</span>,
              <span class="hljs-string">"did:corda:tcn:3df6b0a1-6b02-4053-8900-8c36b6d35fa1#keys-2"</span>
            ],
            <span class="hljs-attr">"pattern"</span>: <span class="hljs-string">"^did:corda:(testnet|tcn|private-[a-z]+):([0-9a-f]{8}\\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\\b[0-9a-f]{12})$"</span>
          },
          <span class="hljs-attr">"type"</span>: {
            <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"#/properties/signatures/items/properties/type"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The cryptographic suite this key has been generated with. More formats (RsaSignature2018, EdDsaSASignatureSecp256k1) to follow."</span>,
            <span class="hljs-attr">"enum"</span>: [
              <span class="hljs-string">"Ed25519Signature2018"</span>
            ]
          },
          <span class="hljs-attr">"signatureBase58"</span>: {
            <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"#/properties/signatures/items/properties/signatureBase58"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The binary signature in Base58 representation. More formats to follow."</span>,
            <span class="hljs-attr">"examples"</span>: [
              <span class="hljs-string">"54CnhKVqE63rMAeM1b8CyQjL4c8teS1DoyTfZnKXRvEEGWK81YA6BAgQHRah4z1VV4aJpd2iRHCrPoNTxGXBBoFw"</span>
            ]
          }
        }
      }
    }
  }
}</code></pre>
            </section>
            <section id="supported-encodings">
                <h5 id="x3-2-1-2-supported-encodings"><bdi class="secno">3.2.1.2 </bdi>Supported Encodings</h5>

                <p>
                </p><table>
                    <thead>
                    <tr>
                        <th>Encoding</th>
                        <th>Description</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><code>signatureHex</code></td>
                        <td>Hex encoded signature.</td>
                    </tr>
                    <tr>
                        <td><code>signatureBase64</code></td>
                        <td>Base64 encoded signature as per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">rfc4648</a></cite>]</td>
                    </tr>
                    <tr>
                        <td><code>signatureBase58</code></td>
                        <td>Base58 encoded signature.</td>
                    </tr>
                    <tr>
                        <td><code>signatureMultibase</code></td>
                        <td>Multibase encoded signature [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Data Format">multibase</a></cite>]
                        </td>
                    </tr>
                    </tbody>
                </table>
                <p></p>

                <section id="examples">
                    <h6 id="x3-2-1-2-1-examples"><bdi class="secno">3.2.1.2.1 </bdi>Examples</h6>

                    <section id="base58">
                        <h6 id="x3-2-1-2-1-1-base58"><bdi class="secno">3.2.1.2.1.1 </bdi>Base58</h6>

                        <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"action"</span>: <span class="hljs-string">"create"</span>,
  <span class="hljs-attr">"signatures"</span>: [
    {
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:corda:tcn:d51924e1-66bb-4971-ab62-ec4910a1fb98#keys-1"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Ed25519Signature2018"</span>,
      <span class="hljs-attr">"signatureBase58"</span>: <span class="hljs-string">"54CnhKVqE63rMAeM1b8CyQjL4c8teS1DoyTfZnKXRvEEGWK81YA6BAgQHRah4z1VV4aJpd2iRHCrPoNTxGXBBoFw"</span>
    }
  ]
}</code></pre>
                    </section>

                    <section id="multibase">
                        <h6 id="x3-2-1-2-1-2-multibase"><bdi class="secno">3.2.1.2.1.2 </bdi>Multibase</h6>

                        <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"action"</span>: <span class="hljs-string">"create"</span>,
  <span class="hljs-attr">"signatures"</span>: [
	{
	  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:corda:tcn:84602311-bd95-4006-968c-01a69d035d64#keys-1"</span>,
	  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Ed25519Signature2018"</span>,
	  <span class="hljs-attr">"signatureMultibase"</span>: <span class="hljs-string">"bb3i4jlob2pomlx5yjv5adir7r26tkor6iqroosojkqi4wq2kcjtiju3moxsrkwmobhtlega27uzuxtncks6yib6otqybfykjyzieqe"</span>
	}
  ]
}</code></pre>
                    </section>

                    <section id="hex">
                        <h6 id="x3-2-1-2-1-3-hex"><bdi class="secno">3.2.1.2.1.3 </bdi>Hex</h6>

                        <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"action"</span>: <span class="hljs-string">"create"</span>,
  <span class="hljs-attr">"signatures"</span>: [
	{
	  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:corda:tcn:03d7411f-ae67-4c89-94b8-de802f017745#keys-1"</span>,
	  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Ed25519Signature2018"</span>,
	  <span class="hljs-attr">"signatureHex"</span>: <span class="hljs-string">"04242D453FA6191B67308B9454E08EC2D59524063F53F85D11E43151283DF672959B9F546CD437FACA914DD15D41F7F6B5FF0AA00ABF5EE91826C70EA83F0E03"</span>
	}
  ]
}</code></pre>
                    </section>

                    <section id="base64">
                        <h6 id="x3-2-1-2-1-4-base64"><bdi class="secno">3.2.1.2.1.4 </bdi>Base64</h6>

                        <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"action"</span>: <span class="hljs-string">"create"</span>,
  <span class="hljs-attr">"signatures"</span>: [
	{
	  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:corda:tcn:4b78d87e-1dee-403d-89d6-d2e12926d309#keys-1"</span>,
	  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Ed25519Signature2018"</span>,
	  <span class="hljs-attr">"signatureBase64"</span>: <span class="hljs-string">"Kh39kEoMvzfolBimiT/6wGeTys5Leuk/M0im9CligIpRXsJnIx4STphsofZBnbX198H7AfuVp8IJYyzMwKtaAg=="</span>
	}
  ]
}</code></pre>
                    </section>
                </section>
            </section>
        </section>
    </section>

    <section id="http-communication">
        <h3 id="x3-3-http-communication"><bdi class="secno">3.3 </bdi>HTTP Communication</h3>

        <p>Envelopes are implemented as <code>multipart/form-data</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7578" title="Returning Values from Forms: multipart/form-data">rfc7578</a></cite>] HTTP requests with two parts:</p>
        <p>
        </p><table>
            <thead>
            <tr>
                <th>Part</th>
                <th>Purpose</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td><code>instruction</code></td>
                <td>JSON representation of the <a href="#instruction">instruction</a></td>
            </tr>
            <tr>
                <td><code>document</code></td>
                <td>JSON Representation of the DID document [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">did-core</a></cite>]</td>
            </tr>
            </tbody>
        </table>
        <p></p>
        <p>This format is chosen to circumvent issues with canonical document representation for hashing.</p>

        <section id="create-did">
            <h4 id="x3-3-1-create-did"><bdi class="secno">3.3.1 </bdi>Create DID</h4>

            <section id="request">
                <h5 id="x3-3-1-1-request"><bdi class="secno">3.3.1.1 </bdi>Request</h5>

                <p>The instruction to create a new DID is issued via a <code>PUT</code> HTTP request [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4122" title="A Universally Unique IDentifier (UUID) URN Namespace">rfc4122</a></cite>].
                    Proof of ownership of the document has to be presented in the envelope.</p>
                <p>The payload includes:</p>
                <ul>
                    <li>The document consisting of the encoded public key, the type of public key and the controller of
                        the
                        public key.
                    </li>
                    <li>The instruction consisting of the action to perform (create), the encoded signature on the
                        document
                        and
                        the type of
                        signature.
                    </li>
                </ul>

                <h6 id="instruction-0">Instruction</h6>

                <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"action"</span>: <span class="hljs-string">"create"</span>,
  <span class="hljs-attr">"signatures"</span>: [
	{
	  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-1"</span>,
	  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Ed25519Signature2018"</span>,
	  <span class="hljs-attr">"signatureBase58"</span>: <span class="hljs-string">"2M12aBn5ijmmUyHtTf56NTJsUEUbpbqbAgpsvxsfMa2KrL5MR5rGb4dP37QoyRWp94kqreDMV9P4K3QHfE67ypTD"</span>
	}
  ]
}</code></pre>

                <h6 id="document">Document</h6>

                <pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://w3id.org/did/v1"</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5"</span>,
  <span class="hljs-attr">"publicKey"</span>: [
	{
	  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-1"</span>,
	  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Ed25519VerificationKey2018"</span>,
	  <span class="hljs-attr">"controller"</span>: <span class="hljs-string">"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5"</span>,
	  <span class="hljs-attr">"publicKeyBase58"</span>: <span class="hljs-string">"GfHq2tTVk9z4eXgyNRg7ikjUaaP1fuE4Ted3d6eBaYSTxq9iokAwcd16hu8v"</span>
	}
  ]
}</code></pre>

                <h6 id="request-example-curl">Request Example (cURL)</h6>

                <pre aria-busy="false"><code class="hljs">curl -X PUT \
http://example.org/did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5 \
  -H 'content-type: multipart/form-data' \
  -F instruction='{
  "action": "create",
  "signatures": [
	{
	  "id": "did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-1",
	  "type": "Ed25519Signature2018",
	  "signatureBase58": "2M12aBn5ijmmUyHtTf56NTJsUEUbpbqbAgpsvxsfMa2KrL5MR5rGb4dP37QoyRWp94kqreDMV9P4K3QHfE67ypTD"
	}
  ]
}' \
  -F document'={
  "@context": "https://w3id.org/did/v1",
  "id": "did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5",
  "created":"2019-07-11T10:27:27.326Z",
  "publicKey": [
	{
	  "id": "did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-1",
	  "type": "Ed25519VerificationKey2018",
	  "controller": "did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5",
	  "publicKeyBase58": "GfHq2tTVk9z4eXgyNRg7ikjUaaP1fuE4Ted3d6eBaYSTxq9iokAwcd16hu8v"
	}
  ]
}'</code></pre>
            </section>
            <section id="response">
                <h5 id="x3-3-1-2-response"><bdi class="secno">3.3.1.2 </bdi>Response</h5>

                <ul>
                    <li>The API will respond with status <code>204</code> for a request with a well-formed instruction
                        <em>and</em> a well-formed document <em>and</em> valid signature(s) <em>and</em> an unused ID.
                    </li>
                    <li>The API will respond with status <code>400</code> for a request with a deformed instruction <em>or</em>
                        a deformed document <em>or</em> at least one invalid signature.
                    </li>
                    <li>The API will respond with status <code>409</code> for a request with an ID that is already
                        taken.
                    </li>
                </ul>
            </section>
        </section>
        <section id="read-did">
            <h4 id="x3-3-2-read-did"><bdi class="secno">3.3.2 </bdi>Read DID</h4>

            <section id="request-0">
                <h5 id="x3-3-2-1-request"><bdi class="secno">3.3.2.1 </bdi>Request</h5>

                <p>A simple <code>GET</code> request [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4122" title="A Universally Unique IDentifier (UUID) URN Namespace">rfc4122</a></cite>] specifying the id as fragment is used to retrieve a DID
                    document.The DID document contains a list of public keys, the type of the public key, information
                    about encodings used on those public keys and the controller of each public key.</p>

                <h6 id="request-example-curl-0">Request Example (cURL)</h6>

                <pre aria-busy="false"><code class="hljs javascript">curl -X GET http:<span class="hljs-comment">//example.org/did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5</span></code></pre>
            </section>
            <section id="response-0">
                <h5 id="x3-3-2-2-response"><bdi class="secno">3.3.2.2 </bdi>Response</h5>

                <pre aria-busy="false"><code class="hljs json">{
<span class="hljs-attr">"@context"</span>:<span class="hljs-string">"https://w3id.org/did/v1"</span>,
<span class="hljs-attr">"id"</span>:<span class="hljs-string">"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5"</span>,
<span class="hljs-attr">"created"</span>:<span class="hljs-string">"2019-07-11T10:27:27.326Z"</span>,
<span class="hljs-attr">"publicKey"</span>:[
        {
            <span class="hljs-attr">"id"</span>:<span class="hljs-string">"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-1"</span>,
            <span class="hljs-attr">"type"</span>:<span class="hljs-string">"Ed25519VerificationKey2018"</span>,
            <span class="hljs-attr">"controller"</span>:<span class="hljs-string">"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5"</span>,
            <span class="hljs-attr">"publicKeyBase58"</span>:<span class="hljs-string">"GfHq2tTVk9z4eXgyNRg7ikjUaaP1fuE4Ted3d6eBaYSTxq9iokAwcd16hu8v"</span>
        }
    ]
}</code></pre>
                <ul>
                    <li>The API will respond with status <code>200</code> for a request with a known ID.</li>
                    <li>The API will respond with status <code>404</code> for a request with an unknown ID.</li>
                    <li>The API will respond with status <code>400</code> for a request with an ID with incorrect
                        format.
                    </li>
                </ul>
            </section>
        </section>

        <section id="update-did">
            <h4 id="x3-3-3-update-did"><bdi class="secno">3.3.3 </bdi>Update DID</h4>

            <section id="request-1">
                <h5 id="x3-3-3-1-request"><bdi class="secno">3.3.3.1 </bdi>Request</h5>

                <p>The instruction to create a new DID is issued via a <code>POST</code> HTTP request [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4122" title="A Universally Unique IDentifier (UUID) URN Namespace">rfc4122</a></cite>].</p>

                <p>Updates use the optional created [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">did-core</a></cite>] and updated [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">did-core</a></cite>] concepts to mitigate replay
                    attacks. This means an update will only be successful if the <code>updated</code> field <em>in the
                        DID document</em> is set to an instant that is later than the instant previously saved with that
                    field. Should no previous update be recorded, the update will only be successful if
                    the <code>created</code> field <em>in the document</em> is set to an instant that is later than the
                    instant provided with the update.
                </p>
                <p>The calculation of the current time is done by the DID owner without verification of its accuracy by
                    the consortium. This is appropriate since this field is only used to determine a before/after
                    relationship. Consumers of the DID document need to take into account that this value is potentially
                    inaccurate.
                </p>
                <p>The Payload includes:</p>
                <ul>
                    <li>The document consisting of the new encoded public key, type of public key, controller of public
                        key.
                    </li>
                    <li>The instruction consisting of action to perform (update), encoded signature(s) on this document
                        using all private keys (including the one being added) associated with the public keys in the
                        document and type of signature.
                    </li>
                </ul>

                <h6 id="request-example-curl-1">Request Example (cURL)</h6>

                <pre aria-busy="false"><code class="hljs">curl -X POST \
http://example.org/did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5 \
  -H 'content-type: multipart/form-data' \
  -F instruction='{
  "action": "update",
  "signatures": [
    {
        "id":"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-1",
        "type":"Ed25519Signature2018",
        "signatureBase58":"57HQXkem7pXpfHnP3DPTyLqSQB9NuZNj7V4hS61kbkQA28hCuYtSmFQCABj8HBX2AmDss13iDkNY2H3zqRZsYnD4"
    },
    {
        "id":"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-2",
        "type":"Ed25519Signature2018",
        "signatureBase58":"26kkhZbQLSNvEKbPvx18GRfSoVMu2bDXutvnWcQQyrGxqz5VKijkFV2GohbkbafPa2WqVad7wnyLwx1zxjvVfvSa"
    }
  ]
}' \
  -F document'={
  "@context": "https://w3id.org/did/v1",
  "id": "did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5",
  "created":"2019-07-11T10:27:27.326Z",
  "updated":"2019-07-11T10:29:15.116Z",
  "publicKey": [
	{
	  "id": "did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-2",
	  "type": "Ed25519VerificationKey2018",
	  "controller": "did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5",
	  "publicKeyBase58": "GfHq2tTVk9z4eXgyHhSTmTRf4NFuTv7afqFroA8QQFXKm9fJcBtMRctowK33"
	}
  ]
}'</code></pre>
            </section>

            <section id="response-1">
                <h5 id="x3-3-3-2-response"><bdi class="secno">3.3.3.2 </bdi>Response</h5>
                <ul>
                    <li>The API will respond with status <code>204</code> if update is successful.</li>
                    <li>The API will respond with status <code>404</code> for a request with an unknown ID.</li>
                    <li>The API will respond with status <code>400</code> for other cases of incorrect payload
                        (mismatched signatures, malformed document, malformed instruction etc.).
                    </li>
                </ul>
            </section>
        </section>
        <section id="delete-did">
            <h4 id="x3-3-4-delete-did"><bdi class="secno">3.3.4 </bdi>Delete DID</h4>
            <section id="request-2">
                <h5 id="x3-3-4-1-request"><bdi class="secno">3.3.4.1 </bdi>Request</h5>

                <p>The instruction to create a new DID is issued via a <code>DELETE</code> HTTP request [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4122" title="A Universally Unique IDentifier (UUID) URN Namespace">rfc4122</a></cite>].</p>

                <p>This method is used to disable the identity on the ledger. Once deleted the identity cannot be used
                    again. Delete accepts only the instruction as payload, the instruction contains signature(s) for the
                    public key(s) of the latest DID document on the ledger.</p>
                <p>The payload includes:</p>
                <ul>
                    <li>The instruction consisting of action to perform (delete), encoded signature on the latest DID
                        document on the ledger using all private keys associated with public keys present in the
                        document
                        and type of the signature.
                    </li>
                </ul>
                <p>To validate a delete request, the user must provide signature(s) in the instruction. The signature(s)
                    must be over the latest did document present in the ledger signed with corresponding private keys
                    for
                    all the public keys present in the document.</p>

                <h6 id="request-example-curl-2">Request Example (cURL)</h6>

                <pre aria-busy="false"><code class="hljs">curl -X DELETE \
http://example.org/did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5 \
  -H 'content-type: multipart/form-data' \
  -F instruction='{
  "action": "delete",
  "signatures": [
    {
        "id":"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-1",
        "type":"Ed25519Signature2018",
        "signatureBase58":"57HQXkem7pXpfHnP3DPTyLqSQB9NuZNj7V4hS61kbkQA28hCuYtSmFQCABj8HBX2AmDss13iDkNY2H3zqRZsYnD4"
    },
    {
        "id":"did:corda:tcn:a609bcc0-a3a8-11e9-b949-fb002eb572a5#keys-2",
        "type":"Ed25519Signature2018",
        "signatureBase58":"26kkhZbQLSNvEKbPvx18GRfSoVMu2bDXutvnWcQQyrGxqz5VKijkFV2GohbkbafPa2WqVad7wnyLwx1zxjvVfvSa"
    }
  ]
}'</code></pre>
            </section>
        </section>
    </section>
</section>


<section class="informative" id="implementation-considerations">
    <h2 id="x4-implementation-considerations"><bdi class="secno">4. </bdi>Implementation Considerations</h2><p><em>This section is non-normative.</em></p>

    <p><em>This outlines the "on-ledger" implementation of the protocol which has only marginal use. As this is likely
        not widely adopted this section is strictly informative.</em></p>

    <p>The DID Flows is the CorDapp component to be deployed by consortium member nodes. It provides method specific
        flows to create, read, update or delete DID documents.
        The DID flows can be invoked from RPC clients or from other flows.</p>

    <section id="create-did-createdidflow">
        <h3 id="x4-1-create-did-createdidflow"><bdi class="secno">4.1 </bdi>Create DID (<em>CreateDidFlow</em>)</h3>

        <p>This is used to create a new DID.
            Proof of ownership of the document has to be presented in the envelope as outlined in the API format.</p>
        <ul>
            <li>
                <p>invoke CreateDidFlow via RPC:
                    <code>rpc.startFlowDynamic(CreateDidFlow::class.java, envelope)</code></p>
            </li>
            <li>
                <p>invoke CreateDidFlow from another flow:<br>
                    <code>subFlow(CreateDidFlow(envelope))</code></p>
            </li>
        </ul>
        <p>where envelope is an instance of type <code>DidEnvelope</code></p>
    </section>

    <section id="read-did-fetchdiddocumentflow">
        <h3 id="x4-2-read-did-fetchdiddocumentflow"><bdi class="secno">4.2 </bdi>Read DID (<em>FetchDidDocumentFlow</em>)</h3>

        <p>This is used to fetch a <code>did</code> document from node's local vault. It returns an instance of type
            <code>DidDocument</code></p>
        <ul>
            <li>
                <p>invoke FetchDidDocumentFlow via RPC:
                    <code>rpc.startFlowDynamic(FetchDidDocumentFlow::class.java, linearId)</code></p>
            </li>
            <li>
                <p>invoke FetchDidDocumentFlow from another flow:<br>
                    <code>subFlow(FetchDidDocumentFlow(linearId))</code></p>
            </li>
        </ul>
        <p>where linearId is an instance of type <code>UniqueIdentifier</code> and it is the UUID part of the
            <code>did</code>.</p>
        <p>There might be a case where a node which is not part of the DID Business Network may request DID document
            from one of the DID consortium nodes.
            In such situations, nodes can invoke <code>FetchDidDocumentFromRegistryNodeFlow</code>.
        </p>
        <ul>
            <li>
                <p>invoke FetchDidFetchDidDocumentFromRegistryNodeFlowDocumentFlow via RPC:
                    <code>rpc.startFlowDynamic(FetchDidDocumentFromRegistryNodeFlow::class.java, didRegistryNode,
                        linearId)</code></p>
            </li>
            <li>
                <p>invoke FetchDidDocumentFromRegistryNodeFlow from another flow:<br>
                    <code>subFlow(FetchDidDocumentFromRegistryNodeFlow(didRegistryNode, linearId))</code></p>
            </li>
        </ul>
        <p>where linearId is an instance of type <code>UniqueIdentifier</code> and it is the UUID part of the
            <code>did</code> and didRegistryNode is an instance of type <code>Party</code> representing the
            <code>did</code> consortium node.</p>
    </section>

    <section id="update-did-updatedidflow">
        <h3 id="x4-3-update-did-updatedidflow"><bdi class="secno">4.3 </bdi>Update DID (<em>UpdateDidFlow</em>)</h3>

        <p>This is used to update an existing DID.</p>
        <ul>
            <li>
                <p>invoke UpdateDidFlow via RPC:
                    <code>rpc.startFlowDynamic(UpdateDidFlow::class.java, envelope)</code></p>
            </li>
            <li>
                <p>invoke UpdateDidFlow from another flow:<br>
                    <code>subFlow(UpdateDidFlow(envelope))</code></p>
            </li>
        </ul>
        <p>where envelope is an instance of type <code>DidEnvelope</code></p>
    </section>

    <section id="delete-did-deletedidflow">
        <h3 id="x4-4-delete-did-deletedidflow"><bdi class="secno">4.4 </bdi>Delete DID (<em>DeleteDidFlow</em>)</h3>

        <p>This is used to disable an existing DID. Delete operation introduces no changes to the DidDocument. It
            expires the DidState and is marked as <code>Consumed</code> on the ledger.
            To validate a delete request, the user must provide signature(s) in the instruction, the signature(s) are on
            the latest <code>did</code> document present in the ledger signed with corresponding private keys for all
            the public keys present in the document.</p>
        <ul>
            <li>
                <p>invoke DeleteDidFlow via RPC:<br>
                    <code>rpc.startFlowDynamic(DeleteDidFlow::class.java, instruction, did)</code></p>
            </li>
            <li>
                <p>invoke DeleteDidFlow from another flow:<br>
                    <code>subFlow(DeleteDidFlow(instruction, did))</code></p>
            </li>
        </ul>
        <p>where instruction is the instruction JSON object (in string form) containing signatures of did-owner on the
            did-document to be deactivated
            and <code>did</code> is the <code>did</code> to be deleted.</p>
    </section>
</section>

<section id="tof" class="appendix"><h2 id="a-list-of-figures"><bdi class="secno">A. </bdi>List of Figures</h2><ul class="tof"><li class="tofline">
    <a class="tocxref" href="#high-level-architecture">Figure <bdi class="figno">1</bdi> <span class="fig-title">The high level network architecture of a Corda network with three consortium nodes.</span></a>
  </li><li class="tofline">
    <a class="tocxref" href="#did-envelope">Figure <bdi class="figno">2</bdi> <span class="fig-title">A DID envelope holds the document payload and signatures over the payload by relevant keys.
            </span></a>
  </li></ul></section>


<section id="references" class="appendix"><h2 id="b-references"><bdi class="secno">B. </bdi>References</h2><section id="informative-references">
        <h3 id="b-1-informative-references"><bdi class="secno">B.1 </bdi>Informative references</h3>
      <dl class="bibliography">
        <dt id="bib-corda-messaging">[corda-messaging]</dt><dd><a href="https://docs.corda.net/messaging.html"><cite>Corda Networking and Messaging</cite></a>. URL: <a href="https://docs.corda.net/messaging.html">https://docs.corda.net/messaging.html</a></dd><dt id="bib-corda-network">[corda-network]</dt><dd><a href="https://corda.network/"><cite>Corda Network Foundation</cite></a>. URL: <a href="https://corda.network/">https://corda.network/</a></dd><dt id="bib-corda-testnet">[corda-testnet]</dt><dd><a href="https://docs.corda.net/head/corda-testnet-intro.html"><cite>Corda Testnet</cite></a>. URL: <a href="https://docs.corda.net/head/corda-testnet-intro.html">https://docs.corda.net/head/corda-testnet-intro.html</a></dd><dt id="bib-corda-whitepaper">[corda-whitepaper]</dt><dd><a href="https://www.r3.com/reports/corda-technical-whitepaper/"><cite>Corda Technical White Paper</cite></a>. Mike Hearn; Richard Gendal Brown. URL: <a href="https://www.r3.com/reports/corda-technical-whitepaper/">https://www.r3.com/reports/corda-technical-whitepaper/</a></dd><dt id="bib-did-core">[did-core]</dt><dd><a href="https://www.w3.org/TR/did-core/"><cite>Decentralized Identifiers (DIDs) v1.0</cite></a>. Drummond Reed; Manu Sporny; Markus Sabadello; Dave Longley; Christopher Allen.  W3C. 25 February 2020. W3C Working Draft. URL: <a href="https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a></dd><dt id="bib-multibase">[multibase]</dt><dd><a href="https://tools.ietf.org/id/draft-multiformats-multibase-00.html"><cite>The Multibase Data Format</cite></a>. J. Benet; M. Sporny. URL: <a href="https://tools.ietf.org/id/draft-multiformats-multibase-00.html">https://tools.ietf.org/id/draft-multiformats-multibase-00.html</a></dd><dt id="bib-rfc4122">[rfc4122]</dt><dd><a href="https://tools.ietf.org/html/rfc4122"><cite>A Universally Unique IDentifier (UUID) URN Namespace</cite></a>. P. Leach; M. Mealling; R. Salz.  IETF. July 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a></dd><dt id="bib-rfc4648">[rfc4648]</dt><dd><a href="https://tools.ietf.org/html/rfc4648"><cite>The Base16, Base32, and Base64 Data Encodings</cite></a>. S. Josefsson.  IETF. October 2006. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a></dd><dt id="bib-rfc7578">[rfc7578]</dt><dd><a href="https://tools.ietf.org/html/rfc7578"><cite>Returning Values from Forms: multipart/form-data</cite></a>. L. Masinter.  IETF. July 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7578">https://tools.ietf.org/html/rfc7578</a></dd>
      </dl></section></section><p role="navigation" id="back-to-top"><a href="#title"><abbr title="Back to Top">↑</abbr></a></p><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script></body></html>